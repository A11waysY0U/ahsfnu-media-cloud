# API文档

## 基础信息
- 基础URL: `/api/v1`
- 静态文件访问: `/uploads`

## 认证相关API

### 获取验证码
- **URL**: `/api/v1/auth/captcha`
- **方法**: GET
- **描述**: 获取图形验证码
- **认证要求**: 无
- **响应**: 验证码图片及ID

### 验证验证码
- **URL**: `/api/v1/auth/verify-captcha`
- **方法**: POST
- **描述**: 验证用户输入的验证码是否正确
- **认证要求**: 无
- **请求体**:
  ```json
  {
    "captcha_id": "验证码ID",
    "captcha_value": "用户输入的验证码"
  }
  ```
- **响应**: 验证结果

### 用户登录
- **URL**: `/api/v1/auth/login`
- **方法**: POST
- **描述**: 用户登录接口
- **认证要求**: 无
- **请求体**:
  ```json
  {
    "username": "用户名",
    "password": "密码",
    "captcha_id": "验证码ID",
    "captcha_value": "验证码值"
  }
  ```
- **响应**: 登录结果及Token信息

### 用户注册
- **URL**: `/api/v1/auth/register`
- **方法**: POST
- **描述**: 用户注册接口
- **认证要求**: 无
- **请求体**:
  ```json
  {
    "username": "用户名",
    "password": "密码",
    "email": "电子邮箱",
    "invite_code": "邀请码",
    "captcha_id": "验证码ID",
    "captcha_value": "验证码值"
  }
  ```
- **响应**: 注册结果及用户信息

## 素材管理API

### 上传素材
- **URL**: `/api/v1/materials`
- **方法**: POST
- **描述**: 上传新的素材文件
- **认证要求**: 需要认证
- **请求体**: 表单数据，包含文件和元数据
- **响应**: 上传结果及素材信息

### 更新素材
- **URL**: `/api/v1/materials/:id`
- **方法**: PUT
- **描述**: 更新指定ID的素材信息
- **认证要求**: 需要认证
- **URL参数**: 
  - id: 素材ID
- **请求体**: 素材更新信息
- **响应**: 更新结果

### 获取单个素材
- **URL**: `/api/v1/materials/:id`
- **方法**: GET
- **描述**: 获取指定ID的素材详细信息
- **认证要求**: 需要认证
- **URL参数**:
  - id: 素材ID
- **响应**: 素材详细信息

### 删除素材
- **URL**: `/api/v1/materials/:id`
- **方法**: DELETE
- **描述**: 删除指定ID的素材
- **认证要求**: 需要认证
- **URL参数**:
  - id: 素材ID
- **响应**: 删除结果

### 搜索素材
- **URL**: `/api/v1/materials`
- **方法**: GET
- **描述**: 根据条件搜索素材
- **认证要求**: 需要认证
- **查询参数**: 支持各种搜索条件
- **响应**: 素材列表及分页信息

### 收藏/取消收藏素材
- **URL**: `/api/v1/materials/:id/star`
- **方法**: POST
- **描述**: 收藏或取消收藏指定素材
- **认证要求**: 需要认证
- **URL参数**:
  - id: 素材ID
- **响应**: 操作结果

## 邀请码管理API

### 生成邀请码
- **URL**: `/api/v1/invite_codes`
- **方法**: POST
- **描述**: 生成新的邀请码
- **认证要求**: 需要认证（可能需要管理员权限）
- **请求体**: 生成邀请码的参数
- **响应**: 生成的邀请码信息

### 获取邀请码列表
- **URL**: `/api/v1/invite_codes`
- **方法**: GET
- **描述**: 获取邀请码列表
- **认证要求**: 需要认证（可能需要管理员权限）
- **响应**: 邀请码列表

## 用户管理API

### 获取个人资料
- **URL**: `/api/v1/profile`
- **方法**: GET
- **描述**: 获取当前登录用户的个人资料
- **认证要求**: 需要认证
- **响应**: 用户个人资料信息

### 更新个人资料
- **URL**: `/api/v1/profile`
- **方法**: PUT
- **描述**: 更新当前登录用户的个人资料
- **认证要求**: 需要认证
- **请求体**: 更新的个人资料信息
- **响应**: 更新结果

### 修改密码
- **URL**: `/api/v1/profile/password`
- **方法**: PUT
- **描述**: 修改当前登录用户的密码
- **认证要求**: 需要认证
- **请求体**: 
  ```json
  {
    "old_password": "旧密码",
    "new_password": "新密码"
  }
  ```
- **响应**: 修改结果

### 获取用户列表
- **URL**: `/api/v1/users`
- **方法**: GET
- **描述**: 获取所有用户列表（管理功能）
- **认证要求**: 需要认证（需要管理员权限）
- **响应**: 用户列表

### 更新用户角色
- **URL**: `/api/v1/users/:id/role`
- **方法**: PUT
- **描述**: 管理员修改用户角色/权限
- **认证要求**: 需要认证（需要管理员权限）
- **URL参数**:
  - id: 用户ID
- **请求体**: 
  ```json
  {
    "role": "新角色"
  }
  ```
- **响应**: 更新结果

### 删除用户
- **URL**: `/api/v1/users/:id`
- **方法**: DELETE
- **描述**: 管理员删除用户
- **认证要求**: 需要认证（需要管理员权限）
- **URL参数**:
  - id: 用户ID
- **响应**: 删除结果

## 标签管理API

### 获取标签列表
- **URL**: `/api/v1/tags`
- **方法**: GET
- **描述**: 获取所有标签列表
- **认证要求**: 需要认证
- **响应**: 标签列表

### 创建标签
- **URL**: `/api/v1/tags`
- **方法**: POST
- **描述**: 创建新标签
- **认证要求**: 需要认证
- **请求体**: 
  ```json
  {
    "name": "标签名称",
    "description": "标签描述"
  }
  ```
- **响应**: 创建结果及标签信息

### 更新标签
- **URL**: `/api/v1/tags/:id`
- **方法**: PUT
- **描述**: 更新指定ID的标签
- **认证要求**: 需要认证
- **URL参数**:
  - id: 标签ID
- **请求体**: 更新的标签信息
- **响应**: 更新结果

### 删除标签
- **URL**: `/api/v1/tags/:id`
- **方法**: DELETE
- **描述**: 删除指定ID的标签
- **认证要求**: 需要认证
- **URL参数**:
  - id: 标签ID
- **响应**: 删除结果

### 为素材添加标签
- **URL**: `/api/v1/tags/:id/materials/:materialId`
- **方法**: POST
- **描述**: 为指定素材添加标签
- **认证要求**: 需要认证
- **URL参数**:
  - id: 标签ID
  - materialId: 素材ID
- **响应**: 操作结果

### 从素材移除标签
- **URL**: `/api/v1/tags/:id/materials/:materialId`
- **方法**: DELETE
- **描述**: 从指定素材移除标签
- **认证要求**: 需要认证
- **URL参数**:
  - id: 标签ID
  - materialId: 素材ID
- **响应**: 操作结果

## 工作流管理API

### 获取工作流列表
- **URL**: `/api/v1/workflows`
- **方法**: GET
- **描述**: 获取所有工作流列表
- **认证要求**: 需要认证
- **响应**: 工作流列表

### 创建工作流
- **URL**: `/api/v1/workflows`
- **方法**: POST
- **描述**: 创建新的工作流
- **认证要求**: 需要认证
- **请求体**: 工作流信息
- **响应**: 创建结果及工作流信息

### 获取单个工作流
- **URL**: `/api/v1/workflows/:id`
- **方法**: GET
- **描述**: 获取指定ID的工作流详细信息
- **认证要求**: 需要认证
- **URL参数**:
  - id: 工作流ID
- **响应**: 工作流详细信息

### 更新工作流
- **URL**: `/api/v1/workflows/:id`
- **方法**: PUT
- **描述**: 更新指定ID的工作流
- **认证要求**: 需要认证
- **URL参数**:
  - id: 工作流ID
- **请求体**: 更新的工作流信息
- **响应**: 更新结果

### 删除工作流
- **URL**: `/api/v1/workflows/:id`
- **方法**: DELETE
- **描述**: 删除指定ID的工作流
- **认证要求**: 需要认证
- **URL参数**:
  - id: 工作流ID
- **响应**: 删除结果

### 添加工作流成员
- **URL**: `/api/v1/workflows/:id/members`
- **方法**: POST
- **描述**: 向指定工作流添加成员
- **认证要求**: 需要认证
- **URL参数**:
  - id: 工作流ID
- **请求体**:
  ```json
  {
    "user_id": "用户ID",
    "role": "成员角色"
  }
  ```
- **响应**: 添加结果

### 移除工作流成员
- **URL**: `/api/v1/workflows/:id/members/:userId`
- **方法**: DELETE
- **描述**: 从指定工作流移除成员
- **认证要求**: 需要认证
- **URL参数**:
  - id: 工作流ID
  - userId: 用户ID
- **响应**: 移除结果
